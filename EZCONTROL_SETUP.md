# הגדרת מערכת ezcontrol בסופו בייס

## 🏢 אודות המערכת

**ezcontrol** - מערכת ניהול זמן לקוחות מתקדמת
- אנרגיה - אינטגרציה - בקרים - מערכות חכמות - טכנולוגיות מתקדמות

## 📋 שלב 1: יצירת פרויקט בסופו בייס

1. היכנס ל-[supabase.com](https://supabase.com)
2. לחץ על "New Project"
3. בחר ארגון או צור חדש
4. תן שם לפרויקט: `ezcontrol-time-tracking`
5. צור סיסמה חזקה למסד הנתונים
6. בחר אזור קרוב (Europe West)
7. לחץ על "Create new project"

## 📊 שלב 2: הגדרת הטבלאות

1. היכנס לפרויקט החדש
2. עבור ל-SQL Editor (בתפריט הצד)
3. לחץ על "New Query"
4. העתק את כל הקוד מקובץ `supabase-schema-complete.sql`
5. לחץ על "Run" (או Ctrl+Enter)

## 🔧 שלב 3: הגדרת API Keys

1. עבור ל-Settings > API
2. העתק את ה-URL וה-anon key
3. עדכן את הקובץ `src/lib/supabase.ts` עם הפרטים החדשים

## 📱 שלב 4: בדיקת המערכת

### בדיקת הטבלאות
1. עבור ל-Table Editor
2. וודא שכל הטבלאות נוצרו:
   - `clients` - לקוחות
   - `sessions` - סשני עבודה
   - `projects` - פרויקטים
   - `system_settings` - הגדרות מערכת
   - `backups` - גיבויים
   - `activity_logs` - לוג פעילות

### בדיקת הגדרות מערכת
1. פתח את הטבלה `system_settings`
2. וודא שיש רשומה עם:
   - `company_name`: "ezcontrol"
   - `company_slogan`: "אנרגיה - אינטגרציה - בקרים - מערכות חכמות - טכנולוגיות מתקדמות"

## 🚀 שלב 5: הפעלת המערכת

1. הרץ את הממשק: `npm run dev`
2. פתח את הדפדפן: `http://localhost:8081`
3. נסה להוסיף לקוח חדש
4. בדוק שהנתונים נשמרים בסופו בייס

## 📊 מבנה הנתונים

### טבלת לקוחות (clients)
```sql
- id: מזהה ייחודי
- name: שם הלקוח
- email: אימייל
- phone: טלפון
- company: חברה
- address: כתובת
- total_hours: סך שעות עבודה
- total_minutes: סך דקות
- total_sessions: מספר סשנים
- last_work_date: תאריך עבודה אחרון
- status: סטטוס (active/inactive)
- notes: הערות
- sessions: היסטוריית סשנים (JSON)
```

### טבלת סשנים (sessions)
```sql
- id: מזהה ייחודי
- client_id: מזהה הלקוח
- date: תאריך
- start_time: זמן התחלה
- end_time: זמן סיום
- hours: שעות עבודה
- minutes: דקות
- description: תיאור העבודה
- project_name: שם הפרויקט
- task_type: סוג המשימה
- status: סטטוס
- rate_per_hour: תעריף לשעה
- total_amount: סכום כולל
```

### טבלת פרויקטים (projects)
```sql
- id: מזהה ייחודי
- client_id: מזהה הלקוח
- name: שם הפרויקט
- description: תיאור
- start_date: תאריך התחלה
- end_date: תאריך סיום
- status: סטטוס
- total_hours: סך שעות
- budget: תקציב
```

## 🔒 אבטחה

### Row Level Security (RLS)
- כל הטבלאות מוגנות ב-RLS
- מדיניות גישה: כל אחד יכול לקרוא ולכתוב
- ניתן לשנות בהמשך לפי צרכי האבטחה

### גיבויים
- גיבוי אוטומטי יומי
- גיבוי ידני דרך הממשק
- שמירה ב-localStorage + סופו בייס

## 📈 תכונות מתקדמות

### טריגרים אוטומטיים
- עדכון סטטיסטיקות לקוח אוטומטי
- לוג פעילות אוטומטי
- עדכון זמן עדכון אוטומטי

### אינדקסים לביצועים
- אינדקסים על שדות חיפוש נפוצים
- אינדקסים על תאריכים
- אינדקסים על סטטוסים

### פונקציות מתקדמות
- חישוב סטטיסטיקות אוטומטי
- לוג פעילות מפורט
- עדכון נתונים אוטומטי

## 🛠️ פתרון בעיות

### שגיאת חיבור
```bash
# בדוק את הקונסול בדפדפן
# וודא שה-URL וה-API Key נכונים
# בדוק שהטבלאות נוצרו
```

### נתונים לא נשמרים
```bash
# בדוק את הרשאות RLS
# בדוק את הקונסול לשגיאות
# נסה לרענן את הדף
```

### ביצועים איטיים
```bash
# בדוק את האינדקסים
# בדוק את גודל הטבלאות
# בדוק את הקונסול לביצועים
```

## 📞 תמיכה

אם נתקלת בבעיות:
1. בדוק את הקונסול בדפדפן
2. בדוק את לוגי הפעילות בסופו בייס
3. בדוק את הגדרות RLS
4. פנה לתמיכה עם פרטי השגיאה

## 🎉 סיום

המערכת מוכנה לשימוש! 
- ✅ טבלאות נוצרו
- ✅ API מוגדר
- ✅ אבטחה מופעלת
- ✅ טריגרים עובדים
- ✅ גיבויים מוכנים

**ezcontrol** - מערכת ניהול זמן מתקדמת! 🚀 